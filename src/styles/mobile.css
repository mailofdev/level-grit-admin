/* =========================================
   Mobile-First PWA Optimizations
   Enhanced mobile UI/UX styles
=========================================== */

/* Viewport and safe area handling */
@supports (padding: max(0px)) {
  :root {
    --safe-area-inset-top: env(safe-area-inset-top, 0px);
    --safe-area-inset-right: env(safe-area-inset-right, 0px);
    --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
    --safe-area-inset-left: env(safe-area-inset-left, 0px);
  }
}

/* Prevent text size adjustment on iOS */
html {
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
  /* Prevent horizontal scrolling */
  overflow-x: hidden;
}

body {
  /* Prevent horizontal scrolling */
  overflow-x: hidden;
  /* Better touch scrolling */
  -webkit-overflow-scrolling: touch;
  /* Prevent pull-to-refresh on mobile */
  overscroll-behavior-y: contain;
}

/* Enhanced touch targets for mobile */
@media (max-width: 768px) {
  /* All interactive elements should be at least 44x44px */
  button,
  .btn,
  a.btn,
  input[type="button"],
  input[type="submit"],
  input[type="checkbox"],
  input[type="radio"],
  .nav-link,
  .dropdown-item,
  .card[role="button"],
  [role="button"] {
    min-height: 44px;
    min-width: 44px;
    touch-action: manipulation; /* Disable double-tap zoom */
  }

  /* Better spacing between touch targets */
  .btn + .btn,
  button + button {
    margin-left: 0.5rem;
  }

  /* Enhanced form inputs */
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="number"],
  input[type="tel"],
  input[type="url"],
  input[type="search"],
  textarea,
  select {
    min-height: 44px;
    font-size: 16px; /* Prevents iOS zoom on focus */
    padding: 0.75rem 1rem;
    -webkit-appearance: none;
    appearance: none;
  }

  /* Better focus states for touch */
  input:focus,
  textarea:focus,
  select:focus {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
  }
}

/* Improved typography for mobile readability */
@media (max-width: 576px) {
  body {
    font-size: 16px;
    line-height: 1.6;
  }

  h1 {
    font-size: 1.75rem;
    line-height: 1.3;
    margin-bottom: 0.75rem;
  }

  h2 {
    font-size: 1.5rem;
    line-height: 1.3;
    margin-bottom: 0.625rem;
  }

  h3 {
    font-size: 1.25rem;
    line-height: 1.4;
    margin-bottom: 0.5rem;
  }

  h4 {
    font-size: 1.1rem;
    line-height: 1.4;
    margin-bottom: 0.5rem;
  }

  h5 {
    font-size: 1rem;
    line-height: 1.4;
    margin-bottom: 0.5rem;
  }

  h6 {
    font-size: 0.9rem;
    line-height: 1.4;
    margin-bottom: 0.5rem;
  }

  p {
    font-size: 0.95rem;
    line-height: 1.6;
    margin-bottom: 0.75rem;
  }

  /* Better list spacing */
  ul, ol {
    padding-left: 1.25rem;
    margin-bottom: 0.75rem;
  }

  li {
    margin-bottom: 0.375rem;
    line-height: 1.6;
  }
}

/* Enhanced spacing system for mobile */
@media (max-width: 768px) {
  /* Container spacing */
  .container,
  .container-fluid {
    padding-left: 0.75rem;
    padding-right: 0.75rem;
  }

  /* Row spacing */
  .row {
    margin-left: -0.5rem;
    margin-right: -0.5rem;
  }

  .row > * {
    padding-left: 0.5rem;
    padding-right: 0.5rem;
  }

  /* Card spacing */
  .card {
    margin-bottom: 1rem;
  }

  .card-body {
    padding: 1rem;
  }

  /* Form spacing */
  .form-group,
  .mb-3 {
    margin-bottom: 1rem !important;
  }

  /* Button spacing */
  .btn-group {
    gap: 0.5rem;
  }

  .btn-group .btn {
    margin: 0;
  }
}

/* Better alignment for mobile */
@media (max-width: 576px) {
  /* Center align text on small screens for better readability */
  .text-start {
    text-align: left !important;
  }

  .text-center {
    text-align: center !important;
  }

  /* Full width buttons on mobile */
  .btn-group-vertical .btn,
  form .btn[type="submit"],
  form .btn-primary {
    width: 100%;
    margin-bottom: 0.75rem;
  }

  /* Better modal on mobile */
  .modal-dialog {
    margin: 0;
    max-width: 100%;
    height: 100%;
    display: flex;
    align-items: flex-end;
  }

  .modal-content {
    border-radius: 1rem 1rem 0 0;
    margin-top: auto;
    max-height: 90vh;
    overflow-y: auto;
  }
}

/* Improved table responsiveness */
@media (max-width: 768px) {
  .table-responsive {
    -webkit-overflow-scrolling: touch;
    border-radius: var(--border-radius);
  }

  .table {
    font-size: 0.875rem;
  }

  .table th,
  .table td {
    padding: 0.75rem 0.5rem;
    white-space: nowrap;
  }
}

/* Better dropdown on mobile */
@media (max-width: 768px) {
  .dropdown-menu {
    max-width: calc(100vw - 2rem);
    left: auto !important;
    right: 1rem !important;
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-lg);
  }
}

/* Enhanced navigation for mobile */
@media (max-width: 768px) {
  .navbar {
    padding: 0.75rem 1rem;
    min-height: 56px;
  }

  .navbar-brand {
    font-size: 1.1rem;
  }

  .navbar-nav .nav-link {
    padding: 0.75rem 1rem;
    font-size: 0.95rem;
  }
}

/* Better image handling on mobile */
img {
  max-width: 100%;
  height: auto;
  display: block;
}

/* Prevent layout shifts */
img[loading="lazy"] {
  min-height: 100px;
  background: var(--color-surface-variant);
}

/* Smooth scrolling for better mobile experience */
@media (prefers-reduced-motion: no-preference) {
  html {
    scroll-behavior: smooth;
  }

  * {
    scroll-behavior: smooth;
  }
}

/* Disable animations for reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* PWA-specific: Prevent overscroll bounce */
body {
  overscroll-behavior-y: none;
  overscroll-behavior-x: none;
}

/* Better focus indicators for keyboard navigation */
*:focus-visible {
  outline: 3px solid var(--color-primary);
  outline-offset: 2px;
  border-radius: 2px;
}

/* Hide focus outline for mouse users */
*:focus:not(:focus-visible) {
  outline: none;
}

/* Improved loading states for mobile */
@media (max-width: 768px) {
  .spinner-border {
    width: 2rem;
    height: 2rem;
    border-width: 0.2em;
  }

  .spinner-border-sm {
    width: 1rem;
    height: 1rem;
    border-width: 0.15em;
  }
}

/* Better toast positioning on mobile */
@media (max-width: 768px) {
  .toast-container {
    padding: 0.75rem;
  }

  .toast {
    margin-bottom: 0.75rem;
    border-radius: var(--border-radius);
  }
}

/* Enhanced accessibility for mobile */
@media (max-width: 768px) {
  /* Ensure sufficient color contrast */
  .text-muted {
    color: var(--color-muted) !important;
    opacity: 0.8;
  }

  /* Better link visibility */
  a {
    text-decoration: underline;
    text-underline-offset: 2px;
  }

  a:hover {
    text-decoration-thickness: 2px;
  }
}

/* Performance optimizations for mobile */
@media (max-width: 768px) {
  /* Reduce repaints */
  .card,
  .btn,
  .modal-content {
    will-change: auto;
  }

  /* Optimize scrolling */
  * {
    -webkit-overflow-scrolling: touch;
  }

  /* Reduce layout shifts */
  .container,
  .container-fluid {
    contain: layout;
  }
}

